System.register("chunks:///_virtual/game.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Level.ts"],(function(t){"use strict";var e,i,o,r,n,s,a,h,l,c,u,g,m,f,b,d,p,C,y,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.defineProperty,r=t.assertThisInitialized,n=t.initializerDefineProperty,s=t.asyncToGenerator},function(t){a=t.cclegacy,h=t._decorator,l=t.Color,c=t.Prefab,u=t.AudioSource,g=t.Label,m=t.Button,f=t.view,b=t.Vec3,d=t.instantiate,p=t.Sprite,C=t.UITransform,y=t.Component},function(t){v=t.Level}],execute:function(){var w,_,x,k,T,B,D,A,L,S,N;a._RF.push({},"5b892c2kOFGJ7YFjJSWdkPy","game",void 0);var z=h.ccclass,P=h.property;t("game",(w=z("game"),_=P(l),x=P(c),k=P(Number),T=P(Number),w((A=e((D=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,o(r(e),"_rowNum",8),o(r(e),"_colNum",6),n(r(e),"defaultColor",A,r(e)),n(r(e),"boxPrefab",L,r(e)),o(r(e),"_boxSize",void 0),o(r(e),"_boxArray",[]),o(r(e),"colorArray",void 0),o(r(e),"countDownTime",60),n(r(e),"_rewardTime",S,r(e)),o(r(e),"rewardTime",0),n(r(e),"punishTime",N,r(e)),o(r(e),"wrongAudioEffect",void 0),o(r(e),"rightAudioEffect",void 0),o(r(e),"scoreLabel",void 0),o(r(e),"countDownTimeLabel",void 0),o(r(e),"alertDialog",void 0),o(r(e),"alertLabel",void 0),o(r(e),"btnOk",void 0),o(r(e),"btnOkLabel",void 0),o(r(e),"score",0),o(r(e),"_gameFinish",void 0),o(r(e),"timeCallback",(function(){this.countDownTime-=1,this.countDownTime<=0&&(this.countDownTime=0),this.countDownTimeLabel.string=this.countDownTime+"",this.isGameFinish()})),e}i(e,t);var a=e.prototype;return a.onLoad=function(){this.wrongAudioEffect=this.getComponents(u)[0],this.rightAudioEffect=this.getComponents(u)[1],this.scoreLabel=this.node.parent.getChildByName("score").getComponent(g),this.countDownTimeLabel=this.node.parent.getChildByPath("timeFrameOut/timeFrameIn/time").getComponent(g),this.alertDialog=this.node.parent.getChildByPath("alert"),this.alertDialog.active=!1,this.alertLabel=this.node.parent.getChildByPath("alert/background/content").getComponent(g),this.btnOk=this.node.parent.getChildByPath("alert/background/btn_ok").getComponent(m),this.btnOk.node.on(m.EventType.CLICK,this.onOkBtnClick,this),this.btnOkLabel=this.node.parent.getChildByPath("alert/background/btn_ok/Label").getComponent(g)},a.start=function(){var t=s(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.getInstance().loadConfig();case 2:this.reStart();case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.reStart=function(){this.reset(),this.countDownTimeLabel.string=this.countDownTime+"",this.createBoxs(),this.schedule(this.timeCallback,1)},a.createBoxs=function(){this._boxSize=Math.floor(f.getVisibleSize().width/this._colNum);for(var t=0;t<this._rowNum;t++){for(var e=t*this._boxSize+this._boxSize/2,i=[],o=0;o<this._colNum;o++){var r,n=o*this._boxSize+this._boxSize/2,s=new b(n,e,0),a=Math.floor(Math.random()*(this.colorArray.length+1));r=a<this.colorArray.length?(new l).fromHEX(this.colorArray[a]):this.defaultColor;var h=this.createBox(s,r,t,o);i[o]=h.getChildByName("body")}this._boxArray[t]=i}},a.createBox=function(t,e,i,o){var r=d(this.boxPrefab);r.setPosition(t),r.getChildByName("body").getComponent(p).color=e,r.getComponent(C).width=this._boxSize,r.getComponent(C).height=this._boxSize,r.getChildByName("background").getComponent(C).width=this._boxSize,r.getChildByName("background").getComponent(C).height=this._boxSize,r.getChildByName("body").getComponent(C).width=.9*this._boxSize,r.getChildByName("body").getComponent(C).height=.9*this._boxSize,this.node.addChild(r);var n=r.getChildByName("body").getComponent("box");return n.setGame(this),n.setPositionInArr(i,o),r},a.retiming=function(){this.isGameFinish()||(this.unschedule(this.timeCallback),this.schedule(this.timeCallback,1))},a.isGameFinish=function(){return this.countDownTime<=0?(this.gameStop(),!0):!!this.noClickBox()&&(this.gameSuccess(),!0)},a.noClickBox=function(){for(var t=0;t<this._boxArray.length;t++)for(var e=this._boxArray[t],i=0;i<e.length;i++){var o=e[i];if(this.compareColor(o.getComponent(p).color,this.defaultColor)){var r=this.findNearestBoxs(o.getComponent("box"));if(this.findClearBoxs(r,!1))return!1}}return!0},a.onBoxClick=function(t){if(!this._gameFinish)if(this.compareColor(t.getComponent(p).color,this.defaultColor)){var e=this.findNearestBoxs(t);this.findClearBoxs(e,!0)?this.clickRight():this.clickWrong()}else this.clickWrong()},a.findNearestBoxs=function(t){for(var e=t.getPositionInArr()[0],i=t.getPositionInArr()[1],o=[],r=e-1;r>=0;r--){var n=this._boxArray[r][i];if(!this.compareColor(n.getComponent(p).color,this.defaultColor)){o.push(n);break}}for(r=e+1;r<this._rowNum;r++){n=this._boxArray[r][i];if(!this.compareColor(n.getComponent(p).color,this.defaultColor)){o.push(n);break}}for(var s=i-1;s>=0;s--){n=this._boxArray[e][s];if(!this.compareColor(n.getComponent(p).color,this.defaultColor)){o.push(n);break}}for(s=i+1;s<this._colNum;s++){n=this._boxArray[e][s];if(!this.compareColor(n.getComponent(p).color,this.defaultColor)){o.push(n);break}}return o},a.findClearBoxs=function(t,e){for(var i=0;i<t.length;i++)t[i].clear=!1;for(var o=0;o<t.length-1;o++){if(t[o].clear){if(e)continue;return!0}for(var r=t[o].getComponent(p).color,n=o+1;n<t.length;n++){var s=t[n].getComponent(p).color;if(this.compareColor(r,s)){if(!e)return!0;t[o].clear=!0,t[n].clear=!0}}}this.rewardTime=0;var a=!1;for(o=0;o<t.length;o++)t[o].clear&&(a=!0,this.clearBox(t[o]));return a},a.clickWrong=function(){this._gameFinish||(this.wrongAudioEffect.play(),this.score-=10,this.scoreLabel.string=""+this.score,this.countDownTime-=this.punishTime,this.countDownTime<=0&&(this.countDownTime=0),this.countDownTimeLabel.string=this.countDownTime+"",this.retiming())},a.clickRight=function(){this._gameFinish||(this.rightAudioEffect.play(),this.scoreLabel.string=""+this.score,this.countDownTime+=this.rewardTime,this.countDownTime<=0&&(this.countDownTime=0),this.countDownTimeLabel.string=this.countDownTime+"",this.retiming())},a.clearBox=function(t){this.score+=10,this.rewardTime+=this._rewardTime,t.getComponent("box").clear()},a.compareColor=function(t,e){return t.r==e.r&&t.g==e.g&&t.b==e.b},a.gameStop=function(){this._gameFinish=!0,this.unschedule(this.timeCallback),this.alertDialog.active=!0,this.alertLabel.string="游戏结束，得分："+this.score,this.btnOkLabel.string="重玩",this.btnOk.node.on(m.EventType.CLICK,this.onOkBtnClick,this)},a.gameSuccess=function(){this.unschedule(this.timeCallback),this._gameFinish=!0,v.getInstance().levelUp()?(this.alertDialog.active=!0,this.alertLabel.string="恭喜过关，得分："+this.score,this.btnOkLabel.string="下一关"):(this.alertDialog.active=!0,this.alertLabel.string="游戏胜利，显示排行榜，得分："+this.score,this.btnOk.node.active=!1)},a.reset=function(){for(var t=0;t<this._boxArray.length;t++)for(var e=0;e<this._boxArray[t].length;e++)this._boxArray[t][e].destroy();this._boxArray=[],this._gameFinish=!1,this.colorArray=v.getInstance().getConfig().colorArray,this.countDownTime=v.getInstance().getConfig().timeout,this._rowNum=v.getInstance().getConfig().rownum,this._colNum=v.getInstance().getConfig().colnum,this.score=0,this.scoreLabel.string=""+this.score,this.unschedule(this.timeCallback)},a.onOkBtnClick=function(){this.alertDialog.active=!1,this.reStart()},e}(y)).prototype,"defaultColor",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(new l).fromHEX("#ffffff")}}),L=e(D.prototype,"boxPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(D.prototype,"_rewardTime",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),N=e(D.prototype,"punishTime",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),B=D))||B));a._RF.pop()}}}));

System.register("chunks:///_virtual/Level.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var n,t,l,o,i,s,r,c;return{setters:[function(e){n=e.defineProperty,t=e.inheritsLoose,l=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,s=e.resources,r=e.JsonAsset,c=e.Component}],execute:function(){var u,a,v;o._RF.push({},"ca391foHPNBO4q/OUm8Gp9X","Level",void 0);var f=i.ccclass;i.property,e("Level",f("Level")((v=a=function(e){function o(){for(var t,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i))||this,n(l(t),"level",1),n(l(t),"levelConfigJson",[]),t}t(o,e),o.getInstance=function(){return null==this.instance&&(this.instance=new o),this.instance};var i=o.prototype;return i.loadConfig=function(){var e=this;return new Promise((function(n,t){s.load("level",r,(function(l,o){console.log(o),e.levelConfigJson=o.json,l?t(l):n("")}))}))},i.levelUp=function(){return this.level!=this.levelConfigJson.length&&(this.level++,!0)},i.getLevel=function(){return this.level},i.clear=function(){this.level=1},i.getConfig=function(){return this.levelConfigJson[this.level-1]},o}(c),n(a,"instance",null),u=v))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/box.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var o,n,e,i,r,s,c,a,u,p;return{setters:[function(t){o=t.inheritsLoose,n=t.defineProperty,e=t.assertThisInitialized},function(t){i=t.cclegacy,r=t._decorator,s=t.Sprite,c=t.Color,a=t.instantiate,u=t.tween,p=t.Component}],execute:function(){var h;i._RF.push({},"fe816Rxw71PErzuCKS7D6by","box",void 0);var l=r.ccclass;r.property,t("box",l("box")(h=function(t){function i(){for(var o,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o=t.call.apply(t,[this].concat(r))||this,n(e(o),"testpro",111),n(e(o),"_game",void 0),n(e(o),"positionInArr",[]),o}o(i,t);var r=i.prototype;return r.onLoad=function(){this.node.on("touch-start",this.on_touch_start,this),this.node.on("touch-end",this.on_touch_end,this)},r.start=function(){},r.setGame=function(t){this._game=t},r.on_touch_start=function(){},r.on_touch_end=function(){this.getComponent(s).color!=c.WHITE&&this._game.onBoxClick(this)},r.setPositionInArr=function(t,o){this.positionInArr[0]=t,this.positionInArr[1]=o},r.getPositionInArr=function(){return this.positionInArr},r.clear=function(){var t=a(this.node);t.parent=this.node.parent,t.setPosition(this.node.position),t.getComponent("box").playClearAnimation(),this.getComponent(s).color=this._game.defaultColor},r.playClearAnimation=function(){var t=this;u(this.getComponent(s)).to(.1,{color:c.TRANSPARENT},{easing:"fade",onUpdate:function(o,n){t.getComponent(s).color=new c(t.getComponent(s).color.r,t.getComponent(s).color.g,t.getComponent(s).color.b,o.a)},onComplete:function(o){t.node.destroy()}}).start()},i}(p))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Level.ts","./game.ts","./box.ts"],(function(){"use strict";return{setters:[null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});